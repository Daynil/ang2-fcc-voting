{"version":3,"sources":["poll-details.component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;YA0BA;gBASI,qBAAoB,YAA0B,EAC1B,YAA0B,EAC1B,WAAwB;oBAFxB,iBAAY,GAAZ,YAAY,CAAc;oBAC1B,iBAAY,GAAZ,YAAY,CAAc;oBAC1B,gBAAW,GAAX,WAAW,CAAa;oBATlC,YAAO,GAAG,IAAI,mBAAY,EAAW,CAAC;oBAKhD,mBAAc,GAAW,IAAI,CAAC;gBAIkB,CAAC;gBAEjD,8BAAQ,GAAR;oBAAA,iBAEC;oBADG,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC,IAAI,CAAC,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,KAAK,GAAG,GAAG,EAAhB,CAAgB,CAAC,CAAC;gBACtE,CAAC;gBAED,qCAAe,GAAf;oBACI,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;gBACxD,CAAC;gBAED,iCAAW,GAAX,UAAY,OAAO;oBACf,EAAE,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC;wBAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBAC3G,CAAC;gBAED,mCAAa,GAAb,UAAc,EAAqB;oBAC/B,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACzD,CAAC;gBAED,gCAAU,GAAV,UAAW,YAAY;oBAAvB,iBAOC;oBANG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,CAAC,KAAK,CAAC;yBACtD,IAAI,CAAC,UAAA,GAAG;wBACL,KAAI,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;wBACrB,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,KAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;wBACjD,KAAI,CAAC,UAAU,CAAC,eAAa,YAAY,CAAC,KAAO,CAAC,CAAC;oBACvD,CAAC,CAAC,CAAC;gBACX,CAAC;gBAED,gCAAU,GAAV,UAAW,IAAY;oBAAvB,iBAGC;oBAFG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;oBAC3B,MAAM,CAAC,UAAU,CAAC,cAAM,OAAA,KAAI,CAAC,cAAc,GAAG,IAAI,EAA1B,CAA0B,EAAE,IAAI,CAAC,CAAC;gBAC9D,CAAC;gBAxCD;oBAAC,YAAK,EAAE;;yDAAA;gBACR;oBAAC,aAAM,EAAE;;4DAAA;gBAET;oBAAC,gBAAS,CAAC,cAAc,CAAC;;iEAAA;gBAtB9B;oBAAC,gBAAS,CAAC;wBACP,QAAQ,EAAE,cAAc;wBACxB,SAAS,EAAE,CAAC,gBAAgB,CAAC;wBAC7B,QAAQ,EAAE,+oBAYT;wBACD,SAAS,EAAE,CAAC,4BAAY,CAAC;qBAC5B,CAAC;;+BAAA;gBA4CF,kBAAC;YAAD,CA3CA,AA2CC,IAAA;YA3CD,qCA2CC,CAAA","file":"poll-details.component.js","sourcesContent":["import {Component, Input, Output, EventEmitter,\r\n        ViewChild, AfterViewInit, ElementRef, OnChanges, OnInit} from \"@angular/core\";\r\nimport {Poll} from \"./Poll\";\r\nimport {ChartService} from \"./chart.service\";\r\nimport {PollsService} from \"./polls.service\";\r\nimport {AuthService} from \"./auth.service\";\r\nimport {Credentials} from \"./User\";\r\n\r\n@Component({\r\n    selector: 'poll-details',\r\n    styleUrls: ['../css/app.css'],\r\n    template: `\r\n        <div class=\"poll-details\">\r\n            <div id=\"details-question\">{{ poll.question }}</div>\r\n            <select name=\"pollChoices\" #choiceSelect>\r\n                <option *ngFor=\"let choice of poll.choices\" [value]=\"choice.text\">{{ choice.text }}</option>\r\n            </select>\r\n            <div class=\"button\" id=\"vote-button\" (click)=\"submitVote(choiceSelect)\">Vote</div>\r\n            <div height=\"300\" width=\"300\">\r\n                <canvas #choicesChart id=\"choices-chart\"></canvas>\r\n            </div>\r\n            <div class=\"breadcrumb\" *ngIf=\"breadcrumbText\">{{ breadcrumbText }}</div>\r\n        </div>\r\n    `,\r\n    providers: [ChartService]\r\n})\r\nexport class PollDetails implements AfterViewInit, OnChanges, OnInit {\r\n    @Input() poll: Poll;\r\n    @Output() onVoted = new EventEmitter<boolean>();\r\n    \r\n    @ViewChild('choicesChart') choicesChart: ElementRef;\r\n    \r\n    creds: Credentials;\r\n    breadcrumbText: string = null;\r\n    \r\n    constructor(private chartService: ChartService,\r\n                private pollsService: PollsService,\r\n                private authService: AuthService) { }\r\n                \r\n    ngOnInit() {\r\n        this.authService.checkLoggedState().then(res => this.creds = res);\r\n    }\r\n    \r\n    ngAfterViewInit() {\r\n        this.generateChart(this.choicesChart.nativeElement);\r\n    }\r\n    \r\n    ngOnChanges(changes) {\r\n        if (this.choicesChart) this.chartService.nextChart(this.choicesChart.nativeElement, this.poll.choices);\r\n    }\r\n        \r\n    generateChart(el: HTMLCanvasElement) {\r\n        this.chartService.createChart(el, this.poll.choices);\r\n    }\r\n    \r\n    submitVote(choiceSelect) {\r\n        this.pollsService.submitVote(this.poll, choiceSelect.value)\r\n            .then(res => {\r\n                this.poll = res.poll;\r\n                this.chartService.updateChart(this.poll.choices);\r\n                this.breadcrumb(`Voted for ${choiceSelect.value}`);\r\n            });\r\n    }\r\n    \r\n    breadcrumb(text: string) {\r\n        this.breadcrumbText = text;\r\n        window.setTimeout(() => this.breadcrumbText = null, 2000);\r\n    }\r\n\r\n}"]}